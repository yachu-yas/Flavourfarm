{% block content %}
{% load static %}
<!-- Recent Top Selling Below -->
<section class="topSellingProducts sectionPadding">
    <div class="todaysDealNavBar sectionNavBar">
        <span>
            <h4>Recent Top Selling</h4>
            <span class="off">20% OFF</span>
        </span>
        <span>
            <a href="/shop.html">View All</a>
        </span>
    </div>


    <h2>Top Selling Products</h2>
    <div class="topSellingContainer sectionContainer">
        {% for i in top_sellings_mini %}
        <div class="todayDealsBox productBox">
            <div class="top">
                <span class="off">{{ i.discount_percentage }}%</span>
                <span><img src="{% static 'images/icons/vegIcon.png' %}" alt=""></span>
            </div>
            <div class="productImg">
                <a href="{% url 'view_product' i.slug %}">
                {% if i.images.first %}
                <img src="{{ i.images.first.image.url }}" alt="{{ i.name }}">
                {% else %}
                <img src="{% static 'images/default-product.png' %}" alt="No image available">
                {% endif %}
                </a>
            </div>

            <div class="productLabel">
                <h4>{{ i.name }}</h4>
            </div>
            <div class="productPrice">
                <span class="oldPrice">₹{{ i.retail_price }}</span>
                <span class="currentPrice">₹{{ i.selling_price }}</span>
            </div>
            <div class="productQtySelect">
                <div class="minus"><h2>&minus;</h2></div>
                <div class="productQtyNos"><input type="number" value="1"></div>
                <div class="plus"><h2>&plus;</h2></div>
            </div>
            {% if i.stock > 0 and i.id %}
                <div class="addTOCartBtn invert">
                <a href="{% url 'user_add_to_cart' i.id 1 %}">Add To Cart</a>
                </div>
            {% else %}
            <div class="addTOCartBtn invert">
                <button>Out Of Stock</button>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</section>
<!-- Recent Top Selling Above -->
{% endblock content %}

{% block script %}
<script>
    var productBox = document.querySelectorAll(".productBox");
    productBox.forEach(function(i) {
        let plusBtn = i.querySelector(".plus");
        let minusBtn = i.querySelector(".minus");
        let qty = i.querySelector("input");

        plusBtn.addEventListener('click', function () {
            if (qty.value < 10) {
                qty.value++;
            }
        });

        minusBtn.addEventListener('click', function () {
            if (qty.value > 1) {
                qty.value--;
            }
        });
    });
</script>
{% endblock script %}
